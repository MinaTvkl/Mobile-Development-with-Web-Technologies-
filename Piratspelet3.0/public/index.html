<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link type="text/css" rel="stylesheet" href="css.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
  <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <meta charset="utf-8" />
  <title>Pirate Game, ARRRGH</title>

  <!-- chat-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Disable tap highlight on IE -->
  <meta name="msapplication-tap-highlight" content="no">

  <!-- Web Application Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Friendly Chat">
  <meta name="theme-color" content="#303F9F">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Friendly Chat">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303F9F">

  <!-- Tile icon for Win8 -->
  <meta name="msapplication-TileColor" content="#3372DF">
  <meta name="msapplication-navbutton-color" content="#303F9F">

  <!-- Material Design Lite -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.orange-indigo.min.css">
  <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>

  <!-- App Styling -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
  <link rel="stylesheet" href="styles/main.css">

  <!-- TODO: Enable First Input Delay polyfill library. -->
  <script
    type="text/javascript">!function (n, e) { var t, o, i, c = [], f = { passive: !0, capture: !0 }, r = new Date, a = "pointerup", u = "pointercancel"; function p(n, c) { t || (t = c, o = n, i = new Date, w(e), s()) } function s() { o >= 0 && o < i - r && (c.forEach(function (n) { n(o, t) }), c = []) } function l(t) { if (t.cancelable) { var o = (t.timeStamp > 1e12 ? new Date : performance.now()) - t.timeStamp; "pointerdown" == t.type ? function (t, o) { function i() { p(t, o), r() } function c() { r() } function r() { e(a, i, f), e(u, c, f) } n(a, i, f), n(u, c, f) }(o, t) : p(o, t) } } function w(n) { ["click", "mousedown", "keydown", "touchstart", "pointerdown"].forEach(function (e) { n(e, l, f) }) } w(n), self.perfMetrics = self.perfMetrics || {}, self.perfMetrics.onFirstInputDelay = function (n) { c.push(n), s() } }(addEventListener, removeEventListener);</script>
  <!-- chat-->


  <!-- update the version number as needed -->
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-app.js"></script>


  <script defer src="https://www.gstatic.com/firebasejs/7.14.2/firebase-auth.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/7.14.2/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-database.js"></script>



  <script defer src="./init-firebase.js"></script>

  <script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-analytics.js"></script>


  <!-- initialize the SDK after all desired features are loaded -->
  <script src="/__/firebase/7.14.2/firebase-app.js"></script>
  <script src="/__/firebase/7.14.2/firebase-auth.js"></script>
  <script src="/__/firebase/7.14.2/firebase-storage.js"></script>
  <script src="/__/firebase/7.14.2/firebase-messaging.js"></script>
  <script src="/__/firebase/7.14.2/firebase-firestore.js"></script>
  <script src="/__/firebase/7.14.2/firebase-performance.js"></script>
  <script src="/__/firebase/init.js"></script>

  <script src="scripts/main.js"></script>
  <script src="cardfunctions.js"></script>
  <script src="script.js"></script>
  <script src="mapsscript.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCxuXYlxmbsxvPR1YOyCuNUPu9cBqj3FGk&callback=initMap"
    async defer></script>
  <script>

    var myVar;

    function loadThemap() {
      myVar = setTimeout(showPage, 3000);
    }


    function showPage() {
      document.getElementById("loader").style.display = "none";
      document.getElementById("intro").style.display = "none";
      document.getElementById("myDiv").style.display = "block";
      initMap();
    }
  </script>
  <script>

    var showTemplateDialog = function () {
      var dialog = document.getElementById('my-dialog');

      if (dialog) {
        dialog.show();
      } else {
        ons.createElement('dialog.html', { append: true })
          .then(function (dialog) {
            dialog.show();
          });
      }
    };

    var hideDialog = function (id) {
      document
        .getElementById(id)
        .hide();
    };
  </script>

  <script>
    window.fn = {};

    window.fn.open = function () {
      var menu = document.getElementById('menu');
      menu.open();
    };

    window.fn.load = function (page) {
      var content = document.getElementById('content');
      var menu = document.getElementById('menu');
      content.load(page)
        .then(menu.close.bind(menu));
    };

  </script>
</head>

<body onload="loadThemap()">

  <ons-toolbar id="header">
    <div class="left">
      <ons-toolbar-button onclick="fn.open()">
        <ons-icon icon="md-menu"></ons-icon>
      </ons-toolbar-button>
    </div>
    <div class="center">
      PIRATSPELET </div>
    <div class="right">
      <ons-toolbar-button icon="ion-navicon" onclick="showTemplateDialog()">Sign out</ons-toolbar-button>
    </div>
  </ons-toolbar>


  <ons-page>
    <ons-tabbar swipeable position="auto" id="header">
      <ons-tab page="play.html" label="Play" icon="md-home" id="play">
      </ons-tab>
      <ons-tab page="maps.html" label="Map" icon="md-settings" active-icon="md-face" id="map">
      </ons-tab>
      <ons-tab page="chat.html" label="Message in a bottle" icon="md-settings" active-icon="md-face" id="chat">
      </ons-tab>
    </ons-tabbar>
  </ons-page>


  <template id="play.html">
    <ons-page id="playcard">
      <ons-toolbar>
        <div class="left">
          <ons-toolbar-button onclick="fn.open()">
            <ons-icon icon="md-menu"></ons-icon>
          </ons-toolbar-button>
        </div>
        <div class="center" id="">Play</div>
      </ons-toolbar>
      <div class="playcard" id="playcard" onclick="getcard()" onload="read()">
        <h1>Aaaaaargh!</h1>
        <p class="cardtext" id="cardtext">
        </p>
      </div>
    </ons-page>

  </template>

  <template id="maps.html">
    <ons-page id="maps">
      <ons-toolbar>
        <div class="left">
          <ons-toolbar-button onclick="fn.open()">
            <ons-icon icon="md-menu"></ons-icon>
          </ons-toolbar-button>
        </div>
        <div class="center">MAP</div>
      </ons-toolbar>
      <div classname="mapdivider">
        <div id="intro">
          <h1>Welcome to our map app</h1>
          <div id="loader"></div>
        </div>
        <div id="myDiv" style="display:none;">


          <div id="googlemap">

          </div>

          <div id="controlWrapper">
            <div class="Locationbuttons">
              <button class="Locationbutton" id="postLocation" onClick="postMyLocation()">Post your Location</button>
              <button class="Locationbutton" id="getOthersLocation" onClick="getOthersLocations()">Get others
                Locations</button>

            </div>

            <div class="zoombuttons">
              <button class="zoombutton" id="zoomInButton">+</button>
              <button class="zoombutton" id="zoomOutButton">-</button>
            </div>
          </div>
        </div>
      </div>
    </ons-page>
  </template>

  <template id="chat.html">
    <ons-page id="chat">
      <ons-toolbar>
        <div class="left">
          <ons-toolbar-button onclick="fn.open()">
            <ons-icon icon="md-menu"></ons-icon>
          </ons-toolbar-button>
        </div>
        <div class="center">Chat</div>
      </ons-toolbar>
      <div class="demo-layout mdl-layout mdl-js-layout mdl-layout--fixed-header">

        <!-- Header section containing logo -->
        <header class="mdl-layout__header mdl-color-text--white mdl-color--light-blue-700">
          <div class="mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-grid">
            <div class="mdl-layout__header-row mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-cell--12-col-desktop">
              <h3><i class="material-icons">chat_bubble_outline</i> Friendly Chat</h3>
            </div>
            <div id="user-container">
              <div hidden id="user-pic"></div>
              <div hidden id="user-name"></div>
              <button hidden id="sign-out" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-color-text--white">
                Sign-out
              </button>
              <button id="sign-in" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-color-text--white">
                <i class="material-icons">account_circle</i>Sign-in with Google
              </button>
            </div>
          </div>
        </header>
      
        <main class="mdl-layout__content mdl-color--grey-100">
          <div id="messages-card-container" class="mdl-cell mdl-cell--12-col mdl-grid">
      
            <!-- Messages container -->
            <div id="messages-card" class="mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-cell--6-col-tablet mdl-cell--6-col-desktop">
              <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                <div id="messages">
                </div>
                <form id="message-form" action="#">
                  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input class="mdl-textfield__input" type="text" id="message" autocomplete="off">
                    <label class="mdl-textfield__label" for="message">Message...</label>
                  </div>
                  <button id="submit" disabled type="submit" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">
                    Send
                  </button>
                </form>
                <form id="image-form" action="#">
                  <input id="mediaCapture" type="file" accept="image/*" capture="camera">
                  <button id="submitImage" title="Add an image" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-color--amber-400 mdl-color-text--white">
                    <i class="material-icons">image</i>
                  </button>
                </form>
              </div>
            </div>
      
            <div id="must-signin-snackbar" class="mdl-js-snackbar mdl-snackbar">
              <div class="mdl-snackbar__text"></div>
              <button class="mdl-snackbar__action" type="button"></button>
            </div>
      
          </div>
        </main>
      </div>
    </ons-page>
  </template>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // // 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥
      // // The Firebase SDK is initialized and available here!
      //
      // firebase.auth().onAuthStateChanged(user => { });
      // firebase.database().ref('/path/to/ref').on('value', snapshot => { });
      // firebase.messaging().requestPermission().then(() => { });
      // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
      //
      // // 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥

      try {
        let app = firebase.app();
        let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
        document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;
      } catch (e) {
        console.error(e);
        document.getElementById('load').innerHTML = 'Error loading the Firebase SDK, check the console.';
      }
    });


    function read(textFile) {
      console.log("clicked")
      var xhr = new XMLHttpRequest;
      xhr.open('GET', textFile)
      xhr.send()
      console.log(xhr)
      xhr.onload = function () {
        if (xhr.readyState === xhr.DONE) {
          if (xhr.status === 200) {
            console.log(xhr.responseText);
            document.getElementById("cardtext").innerHTML = xhr.responseText;

          }
        }
      };

    }

    function show() {
      var pre = document.createElement('pre');
      pre.textContent = this.response;
      document.body.appendChild(pre)
    }

  </script>





</body>

</html>